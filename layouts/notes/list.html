{{- define "main" -}}
<header class="page-header">
  <h1>Knowledge Hub — Notes</h1>
  <p class="muted">A curated knowledge system (not a traditional blog).</p>
  <div class="hub-filters">
    <label>Year: <select id="hubYear"> <option value="all">All</option> </select></label>
    <label>Type: <select id="hubType"> <option value="all">All</option> </select></label>
  </div>
</header>

{{ $sections := slice
  "Historical Risk Events & Black Swan Thinking"
  "Risk Taxonomy & Control Frameworks"
  "Financial Products & Business Functions"
  "Regulatory Guidance"
  "Non-fiction Book Reviews"
  "Quantification & Visualization Ideas"
}}

<div class="hub-sections">
  {{ range $sec := $sections }}
    <section class="hub-section" data-section="{{ $sec }}">
      <h2 id="{{ anchorize $sec }}">{{ $sec }}</h2>
      <div class="hub-list">
        {{ $notes := where site.RegularPages "Section" "notes" }}
        {{ $group := where $notes "Params.section" $sec }}
        {{ if gt (len $group) 0 }}
          {{ range $p := $group }}
            {{ $y := $p.Date.Format "2006" }}
            {{ $t := default "note" $p.Params.kind }}
            <article class="hub-item" data-year="{{ $y }}" data-kind="{{ $t }}">
              <a class="hub-title" href="{{ $p.RelPermalink }}"><strong>{{ $p.Title }}</strong></a>
              {{ with $p.Params.summary }}<div class="hub-summary">{{ . }}</div>{{ end }}
              <div class="hub-meta"> <span>{{ $p.Date.Format "Jan 2, 2006" }}</span> <span class="dot">•</span> <span>{{ $t }}</span> </div>
            </article>
          {{ end }}
        {{ else }}
          <p class="muted">No items yet.</p>
        {{ end }}
      </div>
    </section>
  {{ end }}
</div>

<script src="/assets/js/notes-filter.js"></script>
{{- end -}}
